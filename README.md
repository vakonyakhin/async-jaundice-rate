# Анализатор "желтушности" новостных статей

Этот проект представляет собой асинхронный веб-сервис для анализа текста новостных статей по указанным URL-адресам. Сервис вычисляет "рейтинг желтушности" — показатель, основанный на частоте использования эмоционально окрашенных или "заряженных" слов в тексте.
Пока поддерживается только один новостной сайт - [ИНОСМИ.РУ](https://inosmi.ru/). Для него разработан специальный адаптер, умеющий выделять текст статьи на фоне остальной HTML разметки. Для других новостных сайтов потребуются новые адаптеры, все они будут находиться в каталоге `adapters`. Туда же помещен код для сайта ИНОСМИ.РУ: `adapters/inosmi_ru.py`.

## Основные возможности

- **Асинхронная обработка**: Сервис использует `asyncio` и `aiohttp` для одновременной обработки нескольких URL, что обеспечивает высокую производительность.
- **Анализ текста**: Для каждого URL сервис загружает веб-страницу, извлекает основной текст статьи и очищает его от HTML-тегов.
- **Морфологический анализ**: Текст разбивается на слова, которые приводятся к нормальной форме с помощью библиотеки `pymorphy2`.
- **Расчет рейтинга**: Рейтинг "желтушности" рассчитывается как процентное соотношение "заряженных" слов к общему количеству слов в статье.
- **Веб-интерфейс**: Результаты анализа доступны через простой REST API.

## Технологии

- **Python 3.7+**
- **aiohttp**: Асинхронный HTTP-клиент и веб-сервер.
- **pymorphy2**: Морфологический анализатор для русского языка.
- **anyio**: Библиотека для структурированного асинхронного программирования.
- **pytest** и **pytest-asyncio**: Для написания и запуска асинхронных тестов.

## Установка

1.  **Клонируйте репозиторий:**
    ```bash
    git clone <URL-вашего-репозитория>
    cd <имя-папки-проекта>
    ```

2.  **Создайте и активируйте виртуальное окружение:**
    ```bash
    python -m venv venv
    source venv/bin/activate  # Для Windows: venv\Scripts\activate
    ```

3.  **Установите зависимости:**
    Создайте файл `requirements.txt` со следующим содержимым:
    ```
    aiohttp
    pymorphy2
    anyio
    pytest
    pytest-asyncio
    beautifulsoup4
    async-timeout
    ```
    Затем выполните команду:
    ```bash
    pip install -r requirements.txt
    ```

4.  **Словарь "заряженных" слов:**
    Убедитесь, что в корневой директории проекта находится файл `charged_dict.zip`, содержащий текстовые файлы со списками "заряженных" слов.

## Запуск

### Запуск сервера

Для запуска веб-сервиса выполните команду:
```bash
python server.py
```
Сервер будет запущен по адресу `http://0.0.0.0:8080`.

### Использование API

Отправьте GET-запрос на корневой URL (`/`), передав в параметре `urls` список URL-адресов, разделенных запятыми.

**Пример запроса с помощью `curl`:**
```bash
curl -X GET "http://127.0.0.1:8080/?urls=https://lenta.ru/news/2023/11/20/putin/,https://inosmi.ru/20251107/borba-275515286.html"
```

**Пример ответа:**
```json
[
    {
        "url": "https://lenta.ru/news/2023/11/20/putin/",
        "status": "OK",
        "score": 5.78,
        "words_count": 450,
        "load_time": "1.23"
    },
    {
        "url": "https://inosmi.ru/20251107/borba-275515286.html",
        "status": "FETCH_ERROR",
        "score": null,
        "words_count": null,
        "load_time": "0.00"
    }
]
```

## Запуск тестов

Для проверки корректности работы основных функций проекта запустите тесты с помощью `pytest`:
```bash
pytest
```